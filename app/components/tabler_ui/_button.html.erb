<%
  # Button variant (primary, secondary, success, warning, danger, info, light, dark)
  variant = button.respond_to?(:variant) ? button.variant : 'primary'

  # Outline style
  outline = button.respond_to?(:outline) && button.outline ? 'outline-' : ''

  # Size (sm, lg)
  size_class = button.respond_to?(:size) && button.size.present? ? "btn-#{button.size}" : ''

  # Shape (pill, square)
  shape_class = case button.respond_to?(:shape) ? button.shape : nil
    when 'pill' then 'rounded-pill'
    when 'square' then 'btn-square'
    else ''
  end

  # Icon only
  icon_class = button.respond_to?(:icon_only) && button.icon_only ? 'btn-icon' : ''

  # Additional classes - use [:class] to access OpenStruct attribute, not .class method
  additional_classes = button.respond_to?(:[]) ? button[:class].to_s : ''

  # Build CSS classes
  css_classes = [
    'btn',
    "btn-#{outline}#{variant}",
    size_class,
    shape_class,
    icon_class,
    additional_classes
  ].compact.join(' ')

  # URL or action (supports both :url and :to)
  url = if button.respond_to?(:url) && button.url.present?
          button.url
        elsif button.respond_to?(:to) && button.to.present?
          button.to
        else
          '#'
        end

  # Method (get, post, patch, delete) - use http_method to avoid conflict with Object#method
  http_method = button.respond_to?(:[]) && button[:method] ? button[:method] : :get

  # Target
  target = button.respond_to?(:target) ? button.target : nil

  # Disabled state
  disabled = button.respond_to?(:disabled) && button.disabled

  # Data attributes
  data_attrs = button.respond_to?(:data) && button.data.present? ? button.data : {}

  # Link text/content
  content = button.respond_to?(:text) ? button.text : 'Button'

  # Icon (optional, rendered before text)
  icon_name = button.respond_to?(:icon) ? button.icon : nil

  # Render icon HTML if icon name is present
  icon_html = if icon_name.present?
    icon_component = TablerUi::Icon::Component.new(icon: icon_name)
    icon_component.icon_data
  end
%>

<% if http_method == :get %>
  <%= link_to url, class: css_classes, target: target, disabled: disabled, data: data_attrs do %>
    <%= raw icon_html if icon_html %>
    <%= content %>
  <% end %>
<% else %>
  <%= button_to url, method: http_method, class: css_classes, target: target, disabled: disabled, data: data_attrs do %>
    <%= raw icon_html if icon_html %>
    <%= content %>
  <% end %>
<% end %>
